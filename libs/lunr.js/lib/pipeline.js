/*!
 * lunr.Pipeline
 * Copyright (C) @YEAR Oliver Nightingale
 */
lunr.Pipeline=function(){this._stack=[]},lunr.Pipeline.registeredFunctions=Object.create(null),lunr.Pipeline.registerFunction=function(n,e){e in this.registeredFunctions&&lunr.utils.warn("Overwriting existing registered function: "+e),n.label=e,lunr.Pipeline.registeredFunctions[n.label]=n},lunr.Pipeline.warnIfFunctionNotRegistered=function(n){n.label&&n.label in this.registeredFunctions||lunr.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",n)},lunr.Pipeline.load=function(n){var e=new lunr.Pipeline;return n.forEach(function(n){var i=lunr.Pipeline.registeredFunctions[n];if(!i)throw new Error("Cannot load unregistered function: "+n);e.add(i)}),e},lunr.Pipeline.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(n){lunr.Pipeline.warnIfFunctionNotRegistered(n),this._stack.push(n)},this)},lunr.Pipeline.prototype.after=function(n,e){lunr.Pipeline.warnIfFunctionNotRegistered(e);var i=this._stack.indexOf(n);if(-1==i)throw new Error("Cannot find existingFn");i+=1,this._stack.splice(i,0,e)},lunr.Pipeline.prototype.before=function(n,e){lunr.Pipeline.warnIfFunctionNotRegistered(e);var i=this._stack.indexOf(n);if(-1==i)throw new Error("Cannot find existingFn");this._stack.splice(i,0,e)},lunr.Pipeline.prototype.remove=function(n){var e=this._stack.indexOf(n);-1!=e&&this._stack.splice(e,1)},lunr.Pipeline.prototype.run=function(n){for(var e=this._stack.length,i=0;i<e;i++){for(var t=this._stack[i],r=[],o=0;o<n.length;o++){var l=t(n[o],o,n);if(null!=l&&""!==l)if(Array.isArray(l))for(var u=0;u<l.length;u++)r.push(l[u]);else r.push(l)}n=r}return n},lunr.Pipeline.prototype.runString=function(n,e){var i=new lunr.Token(n,e);return this.run([i]).map(function(n){return n.toString()})},lunr.Pipeline.prototype.reset=function(){this._stack=[]},lunr.Pipeline.prototype.toJSON=function(){return this._stack.map(function(n){return lunr.Pipeline.warnIfFunctionNotRegistered(n),n.label})};