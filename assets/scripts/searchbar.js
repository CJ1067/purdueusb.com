function getSearchQuery(){const e=new URLSearchParams(window.location.search);return e.get("search")||e.get("s")}function loadSearchIndex(){return lunr(function(){this.ref("index"),this.field("title"),this.field("description"),this.field("content"),this.field("author"),this.field("category"),this.field("date"),searchData.forEach(function(e){e.content=unescape(e.content),this.add(e)},this)})}function sanitizeQuery(e){return e.match(/[\\^:~+-]/g)||(e=`${e}*`),e}function onSearchChange(e){let t=(this.value||e).trim();window.history.pushState(null,null,`?s=${encodeURIComponent(t)}`);let n=lastQuery===undefined||lastQuery!=t;if(n&&removeHighlight(),t&&t.length>1&&n){lastQuery=t;var r=searchIndex.search(t);0==r.length&&(r=searchIndex.search(sanitizeQuery(t))),showSearchResults(r)}0!=t.length&&t||hideSearchResults()}function onSearchChangeDebounce(){let e=this.value;clearTimeout(lastQueryTimer),lastQueryTimer=setTimeout(()=>{onSearchChange(e)},120)}function getSearchResultIndices(e){return e.map(e=>parseInt(e.ref))}function hideSearchResults(){let e=document.querySelector("#wiki-items"),t=document.querySelector("#search-results"),n=document.querySelector("#no-search-results");e.classList.remove("none"),t.classList.add("none"),n.classList.add("none")}function removeHighlight(){document.querySelectorAll("article .search-highlight, #search-results .search-highlight").forEach(e=>{e.classList=[];let t=e.parentNode;e.replaceWith(e.innerText),t.normalize()})}function showSearchResults(e){let t=document.querySelector("#wiki-items"),n=document.querySelector("#search-results"),r=document.querySelector("#no-search-results");if(e&&0!=e.length){let s=getSearchResultIndices(e),a=createPostElements(searchData.filter(e=>s.includes(e.index)));n.innerHTML="",a.forEach(e=>n.appendChild(e)),t.classList.add("none"),r.classList.add("none"),n.classList.remove("none"),highlightSearchResults(lastQuery)}else t.classList.add("none"),r.classList.remove("none"),n.classList.add("none"),document.querySelector("#search-query-term").innerHTML=lastQuery}function createPostElements(e){let t=document.querySelector("#wiki-items").firstElementChild;return e.map(e=>{let n=t.cloneNode(!0),r=n.querySelector("#active");r&&(r.id=""),n.href=`${e.url}?s=${lastQuery}`;let s=n.querySelector(".post-title"),a=n.querySelector(".post-description");return s.innerHTML=e.title,a.innerHTML=e.description,n})}function walkHTML(e,t){var n=new RegExp(`([^a-zA-Z]?)(${escapeRegex(t)})`,"i"),r=new RegExp(`([^a-zA-Z]?)(${escapeRegex(t)})`,"i");e.childNodes.forEach(s=>{if(s.nodeType==Node.TEXT_NODE){if(s.nodeValue&&s.nodeValue.match(n)){for(var a=s.nodeValue.split(n),i=0;i<a.length;i++){let t=a[i];if(t.match(r)){var c=document.createElement("span");c.classList.add("highlight","font-bold","pa-1","search-highlight"),c.style.fontSize="inherit",c.appendChild(document.createTextNode(t)),e.insertBefore(c,s)}else e.insertBefore(document.createTextNode(a[i]),s)}e.removeChild(s)}}else walkHTML(s,t)})}function escapeRegex(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function highlightSearchResults(e){document.querySelectorAll("#search-results, article > section:not(:last-child)").forEach(t=>{walkHTML(t,e)})}function onLoadWithSearch(){let e=document.querySelector("#search");["input","paste","blur"].forEach(t=>{e.addEventListener(t,onSearchChangeDebounce)});let t=getSearchQuery();t&&(e.value=t,e.dispatchEvent(new Event("input")))}var lastQuery=undefined,lastQueryTimer=undefined,searchIndex=loadSearchIndex();window.addEventListener("DOMContentLoaded",onLoadWithSearch);